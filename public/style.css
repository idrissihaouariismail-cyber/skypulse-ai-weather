/**
 * SkyPulse Radar - Production Stylesheet
 * FIXED: Map as background, UI as overlays
 */

/* ============================================================================
   CRITICAL: HTML & BODY - Explicit dimensions
   ============================================================================ */

html {
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
  position: fixed;
  top: 0;
  left: 0;
}

body {
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
  position: fixed;
  top: 0;
  left: 0;
  background: #000;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-tap-highlight-color: transparent;
  touch-action: none;
}

/* ============================================================================
   MAP CONTAINER - BACKGROUND LAYER (z-index: 1)
   ============================================================================ */

#map {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  min-width: 100vw !important;
  min-height: 100vh !important;
  z-index: 1 !important;  /* LOWEST - Background layer */
  background: #1a1a1a;
  margin: 0;
  padding: 0;
}

/* Leaflet Container - Inherit from #map */
.leaflet-container {
  width: 100% !important;
  height: 100% !important;
  min-width: 100% !important;
  min-height: 100% !important;
  background: #1a1a1a !important;
  font-family: inherit !important;
  position: relative !important;
  outline: none !important;
  z-index: 1 !important;
}

/* Leaflet Map Pane */
.leaflet-pane {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
}

/* Leaflet Tile Container */
.leaflet-tile-container {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 1;
}

/* ============================================================================
   UI OVERLAYS - All positioned above map (z-index: 1000+)
   ============================================================================ */

/* Base class for all UI overlays */
.ui-overlay {
  position: fixed;
  z-index: 1000;  /* HIGHER than map */
  pointer-events: auto;  /* Allow interaction */
}

/* ============================================================================
   LOADING INDICATOR - Overlay
   ============================================================================ */

.loading {
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 2000;  /* Above map, below error */
  text-align: center;
  background: rgba(0, 0, 0, 0.85);
  padding: 24px 32px;
  border-radius: 16px;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
  pointer-events: none;  /* Allow clicks through when hidden */
}

.spinner {
  border: 3px solid rgba(255, 255, 255, 0.2);
  border-top: 3px solid #fff;
  border-radius: 50%;
  width: 48px;
  height: 48px;
  animation: spin 1s linear infinite;
  margin: 0 auto 16px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.loading-text {
  color: #fff;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: 0.5px;
}

/* ============================================================================
   ERROR MESSAGE - Overlay
   ============================================================================ */

.error {
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 3000;  /* HIGHEST - Always on top */
  color: #ff6b6b;
  font-size: 14px;
  text-align: center;
  background: rgba(0, 0, 0, 0.9);
  padding: 20px 30px;
  border-radius: 12px;
  max-width: 80%;
  border: 1px solid rgba(255, 107, 107, 0.3);
  box-shadow: 0 8px 32px rgba(255, 107, 107, 0.2);
  word-wrap: break-word;
  pointer-events: auto;  /* Allow interaction */
}

/* ============================================================================
   ATTRIBUTION - Overlay (bottom-right)
   ============================================================================ */

.leaflet-control-attribution {
  background: rgba(0, 0, 0, 0.8) !important;
  color: rgba(255, 255, 255, 0.7) !important;
  font-size: 10px !important;
  padding: 4px 8px !important;
  border-radius: 4px !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5) !important;
  z-index: 1500 !important;  /* Above map, below other UI */
}

.leaflet-control-attribution a {
  color: rgba(255, 255, 255, 0.9) !important;
}

/* Hide zoom controls */
.leaflet-control-zoom {
  display: none !important;
}

/* ============================================================================
   MOBILE OPTIMIZATIONS
   ============================================================================ */

@media (max-width: 768px) {
  .loading {
    padding: 20px 24px;
    border-radius: 12px;
  }
  
  .spinner {
    width: 40px;
    height: 40px;
    border-width: 2px;
  }
  
  .loading-text {
    font-size: 13px;
  }
  
  .error {
    font-size: 13px;
    padding: 16px 24px;
    max-width: 90%;
  }
  
  .leaflet-control-attribution {
    font-size: 9px !important;
    padding: 2px 6px !important;
  }
}

/* ============================================================================
   ACCESSIBILITY & UX
   ============================================================================ */

body {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

/* Prevent transforms that break rendering */
html, body {
  transform: none !important;
}

/* ============================================================================
   PERFORMANCE
   ============================================================================ */

#map {
  will-change: transform;
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
}

.leaflet-container {
  will-change: transform;
}

/* ============================================================================
   CRITICAL: Ensure no containers block the map
   ============================================================================ */

/* Remove any full-height blocking containers */
body > *:not(#map) {
  position: fixed !important;
  /* Never use position: absolute or static for UI elements */
}

/* Ensure map is always visible */
#map {
  visibility: visible !important;
  opacity: 1 !important;
  display: block !important;
}
